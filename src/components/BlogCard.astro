---
import FormattedDate from './FormattedDate.astro';
import TagList from './TagList.astro';
import OptimizedImage from './OptimizedImage.astro';

const { post } = Astro.props;

const heroSrc = post.data.heroImage || `/placeholder.svg?height=360&width=640&query=${encodeURIComponent(post.data.title)}`;
---

<article class="relative isolate flex flex-col gap-8 lg:flex-row">
  <div class="relative aspect-[16/9] sm:aspect-[2/1] lg:aspect-square lg:w-64 lg:shrink-0">
    <OptimizedImage
      src={heroSrc}
      alt={post.data.title}
      width={480}
      height={200}
      class="absolute inset-0 h-full w-full rounded-2xl bg-muted object-cover"
      sizes="(max-width: 1023px) 100vw, 256px"
      loading="lazy"
      format="webp"
    />
    <div class="absolute inset-0 rounded-2xl ring-1 ring-inset ring-border"></div>
  </div>
  <div>
    <div class="flex items-center gap-x-4 text-xs">
      <FormattedDate date={post.data.pubDate} class="text-muted-foreground" />
      {post.data.tags.length > 0 && (
        <TagList tags={post.data.tags.slice(0, 2)} />
      )}
    </div>
    <div class="group relative max-w-xl">
      <h3 class="mt-3 text-lg font-semibold leading-6 text-foreground group-hover:text-primary">
        <a href={`/blog/${post.slug}/`}>
          <span class="absolute inset-0"></span>
          {post.data.title}
        </a>
      </h3>
      <p class="mt-5 text-sm leading-6 text-muted-foreground line-clamp-3">
        {post.data.description}
      </p>
    </div>
    <div class="mt-6 flex border-t border-border pt-6">
      <div class="relative flex items-center gap-x-4">
        <div class="text-sm leading-6">
          <p class="font-semibold text-foreground">
            <a href={`/blog/${post.slug}/`} class="hover:text-primary">
              Read more
            </a>
          </p>
        </div>
      </div>
    </div>
  </div>
</article>
